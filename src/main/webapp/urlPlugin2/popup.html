<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>urlPlugin-title</title>
    <!--bootstrap-->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.css" rel="stylesheet">
	<!--select 插件 select2-->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />

    <link href="main.css" rel="stylesheet">
</head>
<body>
	<div class="container">
        <div class="btn-group save" role="group" aria-label="...">
            <button type="button" class="btn btn-default account">
                <span class="glyphicon glyphicon glyphicon-user" aria-hidden="true">remixchen@qq.com</span>
            </button>
            <button type="button" class="btn btn-default">取消</button>
            <button type="button" class="btn btn-default">保存</button>
        </div>
        <div class="input-group input-group-sm title">
            <input type="text" class="form-control test" placeholder="Title">
        </div>
		<select class="select2-tag"></select>
		<select class="select2-subTag"></select>
	</div>

	<div class="log">
		<span>Log</span>
	</div>

    <!--bootstrap-->
    <script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.js"></script>
    <script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.js"></script>
	<!--select 插件 select2-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>

    <script src="data.js"></script>
	<script type="text/javascript">
        var dataCount = 1;
		var $div = $(".log");

        var $tag = $(".select2-tag");
        var $subTag = $(".select2-subTag");

        $(document).ready(function () {
            $tag.on("select2:select", function (e) { changeSub("select2:select", e); });
            $subTag.on("select2:select", function (e) { changeSub("select2:select", e); });

            $tag.select2({
                /*ajax: {
                    url: 'https://api.github.com/search/repositories',
                    dataType: 'json'
                    // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
                },*/
                placeholder: "请选择一个标签",
				tags: true,
				data: data
            });


            $subTag.select2({
                placeholder: "请选择一个标签",
                tags: true,
                data: subDataInit
            });
        });

        // 子选择框根据父选择框选择的内容改动而改动
        function changeSub (name, evt) {
            var selectedID = evt.params.data.id;
            for(i in subDatas){
                if(subDatas[i].id == selectedID){
                    $subTag.val(null).trigger('change');

                    $subTag.empty();
                    $subTag.select2({
                        tags: true,
                        data: subDatas[i].sub
                    });
                    return;
                }
            }
        }

        function log (name, evt) {
            if (!evt) {
                var args = "{}";
            } else {
                var args = JSON.stringify(evt.params, function (key, value) {
                    if (value && value.nodeName) return "[DOM node]";
                    if (value instanceof $.Event) return "[$.Event]";
                    return value;
                });
            }
            var $e = $("<li>" + name + " -> " + args + "</li>");
            $div.append($e);
            $e.animate({ opacity: 1 }, 1000000, 'linear', function () {
                $e.animate({ opacity: 0 }, 2000, 'linear', function () {
                    $e.remove();
                });
            });
        }

	</script>
</body>
</html>